<section class="interactive-tabs-section">
    <div class="container interactive-tabs-grid">
        <div class="tabs-navigation" data-aos="fade-right">
            <button
                class="tab-button active"
                data-tab="daily-schedule"
                data-i18n="tab_button_daily_schedule"
            >Daily Schedule</button>
            <button
                class="tab-button"
                data-tab="saturday-activities"
                data-i18n="tab_button_monthly_sports"
            >Monthly Sports Day</button>
            <button
                class="tab-button"
                data-tab="friday-activities"
                data-i18n="tab_button_friday_activities"
            >Friday Activities</button>
        </div>

        <div class="tabs-content-wrapper" data-aos="fade-left">
            <div id="daily-schedule" class="tab-panel active">
                <h3 class="tab-panel-title" data-i18n="schedule_daily_title">
                    Our Daily Routine at Tharlam Academy
                </h3>
                <p class="tab-panel-intro" data-i18n="schedule_daily_intro">
                    Each day is thoughtfully structured to balance spiritual
                    practice, academic learning, and personal development.
                </p>
                <div class="schedule-table-wrapper">
                    <table class="daily-schedule-table">
                        <thead>
                            <tr>
                                <th data-i18n="schedule_daily_time_header">Time</th>
                                <th data-i18n="schedule_daily_activity_header">Activity</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr
                                ><td>5:30 AM</td><td
                                    data-i18n="schedule_daily_activity_1"
                                >Morning Puja and Prayers</td
                                ></tr
                            >
                            <tr
                                ><td>7:00 AM</td><td
                                    data-i18n="schedule_daily_activity_2"
                                >Breakfast</td
                                ></tr
                            >
                            <tr
                                ><td>7:40 AM</td><td
                                    data-i18n="schedule_daily_activity_3"
                                >Avalokiteshvara Prayer & Meditation</td
                                ></tr
                            >
                            <tr
                                ><td>10:30 AM</td><td
                                    data-i18n="schedule_daily_activity_4"
                                >Academic Classes</td
                                ></tr
                            >
                            <tr
                                ><td>3:30 PM</td><td
                                    data-i18n="schedule_daily_activity_5"
                                >Sports and Play Time</td
                                ></tr
                            >
                            <tr
                                ><td>6:00 PM</td><td
                                    data-i18n="schedule_daily_activity_6"
                                >Dinner Break</td
                                ></tr
                            >
                            <tr
                                ><td>8:30 PM</td><td
                                    data-i18n="schedule_daily_activity_7"
                                >Homework and Self-Study</td
                                ></tr
                            >
                            <tr
                                ><td>9:30 PM</td><td
                                    data-i18n="schedule_daily_activity_8"
                                >Sleeping Time</td
                                ></tr
                            >
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="saturday-activities" class="tab-panel">
                <h3 class="tab-panel-title" data-i18n="schedule_sports_title">Monthly Sports Day</h3>
                <p class="tab-panel-intro" data-i18n="schedule_sports_intro">
                    At the end of every month, a special **Sports Day** is
                    organized to foster skills, teamwork, and healthy
                    competition.
                </p>
                <div class="schedule-table-wrapper">
                    <table class="daily-schedule-table">
                        <thead>
                            <tr>
                                <th data-i18n="schedule_sports_game_header">Game</th>
                                <th data-i18n="schedule_sports_participants_header">Participants</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr
                                ><td
                                    data-i18n="schedule_sports_game_1"
                                >Football</td
                                ><td
                                    data-i18n="schedule_sports_participants_1"
                                >Inter-house competition</td
                                ></tr
                            >
                            <tr
                                ><td
                                    data-i18n="schedule_sports_game_2"
                                >Relay Race</td
                                ><td
                                    data-i18n="schedule_sports_participants_2"
                                >Inter-house competition</td
                                ></tr
                            >
                            <tr
                                ><td
                                    data-i18n="schedule_sports_game_3"
                                >Kabaddi</td
                                ><td
                                    data-i18n="schedule_sports_participants_3"
                                >Inter-house competition</td
                                ></tr
                            >
                            <tr
                                ><td
                                    data-i18n="schedule_sports_game_4"
                                >Volleyball</td
                                ><td
                                    data-i18n="schedule_sports_participants_4"
                                >Inter-house competition</td
                                ></tr
                            >
                            <tr
                                ><td
                                    data-i18n="schedule_sports_game_5"
                                >High Jump & Long Jump</td
                                ><td
                                    data-i18n="schedule_sports_participants_5"
                                >Inter-house competition</td
                                ></tr
                            >
                            <tr
                                ><td
                                    data-i18n="schedule_sports_game_6"
                                >Various Games</td
                                ><td
                                    data-i18n="schedule_sports_participants_6"
                                >Other inter-house competitions and
                                recreational activities</td
                                ></tr
                            >
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="friday-activities" class="tab-panel">
                <h3 class="tab-panel-title" data-i18n="schedule_friday_title">Weekly Friday Activities</h3>
                <p class="tab-panel-intro" data-i18n="schedule_friday_intro">
                    Every Friday is dedicated to diverse extracurricular
                    activities, fostering creative expression and critical
                    thinking.
                </p>
                <div class="schedule-table-wrapper">
                    <table class="daily-schedule-table">
                        <thead>
                            <tr>
                                <th data-i18n="schedule_friday_activity_header">Activity</th>
                                <th data-i18n="schedule_friday_description_header">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td
                                    data-i18n="schedule_friday_activity_1"
                                >Speech & Presentation</td
                                >
                                <td
                                    data-i18n="schedule_friday_description_1"
                                >Students practice public speaking and
                                presentation skills in English, Tibetan, and
                                Nepali.</td
                                >
                            </tr>
                            <tr>
                                <td
                                    data-i18n="schedule_friday_activity_2"
                                >General Knowledge Quiz</td
                                >
                                <td
                                    data-i18n="schedule_friday_description_2"
                                >Engaging quizzes on various subjects to
                                test and expand students' knowledge.</td
                                >
                            </tr>
                            <tr>
                                <td
                                    data-i18n="schedule_friday_activity_3"
                                >Creative Project Work</td
                                >
                                <td
                                    data-i18n="schedule_friday_description_3"
                                >Collaborative projects focused on topics
                                like water preservation, animal welfare, and
                                natural phenomena.</td
                                >
                            </tr>
                            <tr>
                                <td
                                    data-i18n="schedule_friday_activity_4"
                                >Debate & Discussion</td
                                >
                                <td
                                    data-i18n="schedule_friday_description_4"
                                >Structured debates on diverse topics such
                                as education impact and internet usage.</td
                                >
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    /* Color Palette */
    :root {
        --primary-blue: #001f3f;
        --accent-gold: #ffc107;
        --text-light: #555;
        --background-light: #f9f9f9;
        --border-color: #e0e0e0;
        --shadow-light: 0 4px 12px rgba(0, 0, 0, 0.08);
    }

    /* General Layout */
    .interactive-tabs-section {
        padding: 60px 0;
        background-color: var(--background-light);
    }

    /* Desktop Vertical Layout */
    .interactive-tabs-grid {
        display: flex;
        flex-direction: row;
        gap: 30px;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
    }

    /* Tabs Navigation Styling (The Buttons) */
    .tabs-navigation {
        display: flex;
        flex-direction: column;
        flex-shrink: 0;
        width: 220px;
        background-color: white;
        border-radius: 8px;
        padding: 10px 0;
        box-shadow: var(--shadow-light);
        height: fit-content;
    }

    .tab-button {
        flex-shrink: 0;
        padding: 12px 20px;
        font-size: 16px;
        font-weight: 600;
        color: var(--text-light);
        background-color: transparent;
        border: none;
        text-align: left;
        border-left: 3px solid transparent;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .tab-button:hover:not(.active) {
        color: var(--primary-blue);
        background-color: #f0f0f0;
    }

    /* Active Tab Indicator (Vertical bar on the left) */
    .tab-button.active {
        color: var(--primary-blue);
        font-weight: 700;
        border-left: 3px solid var(--primary-blue);
        background-color: var(--background-light);
    }

    /* Tab Content Styling */
    .tabs-content-wrapper {
        flex-grow: 1;
        background-color: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: var(--shadow-light);
        min-height: 400px;
    }

    .tab-panel-title {
        font-size: 28px;
        color: var(--primary-blue);
        margin-bottom: 10px;
        border-bottom: 2px solid var(--border-color);
        padding-bottom: 10px;
    }

    .tab-panel-intro {
        font-size: 17px;
        color: var(--text-light);
        line-height: 1.6;
        margin-bottom: 30px;
    }

    /* Table Styling */
    .daily-schedule-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 16px;
    }

    .daily-schedule-table th,
    .daily-schedule-table td {
        padding: 12px 15px;
        text-align: left;
    }

    .daily-schedule-table thead th {
        background-color: var(--primary-blue);
        color: white;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .daily-schedule-table tbody tr:nth-child(odd) {
        background-color: #f6f6f6;
    }

    .daily-schedule-table td:first-child {
        font-weight: 600;
        color: var(--primary-blue);
        width: 120px;
    }

    /* ðŸš¨ VISIBILITY FIX ðŸš¨ */
    .tab-panel {
        display: none; /* Hides all panels by default on load */
        opacity: 0;
        animation: fadeIn 0.5s ease-out forwards;
    }

    .tab-panel.active {
        display: block; /* Shows only the panel with the 'active' class */
        opacity: 1;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* ðŸ“± Responsive Adjustments (Mobile: Under 768px) ðŸ“± */
    @media (max-width: 768px) {
        /* Layout and Padding Fix */
        .interactive-tabs-section {
            padding: 40px 0;
        }

        .interactive-tabs-grid {
            flex-direction: column;
            gap: 20px;
            padding: 0 10px; /* Reduced margin/padding */
        }

        /* Mobile Tab Bar (Horizontal Scrollable) */
        .tabs-navigation {
            flex-direction: row;
            width: 100%;
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--shadow-light);
            overflow-x: auto;
            white-space: nowrap;
            padding: 10px; /* Spacing inside the scrollable bar */

            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .tabs-navigation::-webkit-scrollbar {
            display: none;
        }

        /* Mobile Tab Buttons */
        .tab-button {
            flex-shrink: 0;
            min-width: 120px;
            text-align: center;
            border-bottom: 3px solid transparent;
            margin-right: 15px;
            background-color: transparent;
            padding: 8px 10px;
            font-size: 15px;
        }

        /* Mobile Active Tab Indicator */
        .tab-button.active {
            border-bottom: 3px solid var(--primary-blue);
            background-color: transparent;
            color: var(--primary-blue);
            font-weight: 700;
        }

        /* Tab Content Styling (Retained Padding Fix) */
        .tabs-content-wrapper {
            padding: 20px 15px;
        }

        /* Smaller Headings and Text for mobile */
        .tab-panel-title {
            font-size: 22px;
            padding-bottom: 8px;
        }

        .tab-panel-intro {
            font-size: 15px;
            margin-bottom: 20px;
        }

        .daily-schedule-table {
            font-size: 14px;
        }

        .daily-schedule-table th,
        .daily-schedule-table td {
            padding: 8px 10px;
        }
    }
</style>
<script>
    // src/Scripts/scheduleTabs.js

/**
 * Initializes the schedule tab switching functionality.
 * This function is designed to be safe to run multiple times 
 * (for Astro View Transitions) by ensuring old listeners are removed.
 */
function initializeScheduleTabs() {
    // --- 1. Element Selection (Safe to run inside here) ---
    const tabButtons = document.querySelectorAll(".tab-button");
    const tabPanels = document.querySelectorAll(".tab-panel");

    if (tabButtons.length === 0 || tabPanels.length === 0) {
        return;
    }

    // --- 2. Core Tab Switching Logic ---
    const handleTabClick = (button) => {
        const targetTabId = button.dataset.tab;

        // 1. Remove 'active' class from all buttons
        tabButtons.forEach((btn) => btn.classList.remove("active"));

        // 2. Hide and reset all tab panels (for fade animation)
        tabPanels.forEach((panel) => {
            panel.classList.remove("active");
            panel.style.animation = "none";
            panel.offsetHeight; // Forces reflow
        });

        // 3. Activate the clicked button
        button.classList.add("active");

        // 4. Show the corresponding tab panel
        const targetPanel = document.getElementById(targetTabId);
        if (targetPanel) {
            targetPanel.classList.add("active");
            targetPanel.style.animation = "fadeIn 0.5s ease-out forwards";
        }
    };
    
    // --- 3. Event Listener Management (The Clean Fix) ---

    // Define the specific click handler function used for listeners.
    // This allows us to remove it later by reference.
    const tabListener = (event) => {
        handleTabClick(event.currentTarget);
    };

    tabButtons.forEach((button) => {
        // ðŸš¨ CRITICAL FIX: Remove previous listener first.
        // We use the same function reference (`tabListener`) for removal and addition.
        button.removeEventListener("click", tabListener);
        
        // Add the new listener
        button.addEventListener("click", tabListener);
    });
    
    // --- 4. Default Activation (Ensure a tab is visible on load) ---
    // If no tab is marked active in HTML, activate the first one.
    const activeTab = document.querySelector(".tab-button.active");
    if (!activeTab && tabButtons.length > 0) {
        handleTabClick(tabButtons[0]);
    } else if (activeTab) {
        // Run the handler on the active tab to show the panel content
        handleTabClick(activeTab);
    }
}


// --- EXECUTION TRIGGERS (Astro Fix) ---

// 1. Initial Load (Hard navigation)
document.addEventListener("DOMContentLoaded", initializeScheduleTabs);

// 2. Astro View Transition (Soft navigation)
document.addEventListener("astro:page-load", initializeScheduleTabs);
</script>